<!DOCTYPE html>
<html>
<head>
    <title>kaoic08@gmail.com å°ˆç”¨ç™»å…¥æ¸¬è©¦</title>
    <meta charset="UTF-8">
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background: #f5f5f5; }
        .container { max-width: 800px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; }
        .status { background: #e3f2fd; padding: 15px; border-radius: 4px; margin: 10px 0; }
        .error { background: #ffebee; color: #c62828; }
        .success { background: #e8f5e8; color: #2e7d32; }
        button { background: #1976d2; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; margin: 5px; }
        .info-box { background: #fff3e0; padding: 15px; border-left: 4px solid #ff9800; margin: 15px 0; }
    </style>
</head>
<body>
    <div class="container">
        <h1>kaoic08@gmail.com PRO æœƒå“¡å°ˆç”¨è¨ºæ–·</h1>
        
        <div class="info-box">
            <h3>ğŸ¯ å·²çŸ¥ç‹€æ…‹</h3>
            <p>âœ… PRO çµ‚èº«æœƒå“¡ (2099å¹´åˆ°æœŸ)</p>
            <p>âœ… 350 ç©åˆ†é¤˜é¡</p>
            <p>âš ï¸ æœ€å¾ŒæˆåŠŸç™»å…¥ï¼š2025-08-04 (10å¤©å‰)</p>
            <p>ğŸ”§ Token å·²åˆ·æ–°è‡³ 48 å°æ™‚æœ‰æ•ˆ</p>
        </div>
        
        <div id="status" class="status">æª¢æŸ¥ä¸­...</div>
        
        <h2>è¨ºæ–·æ¸¬è©¦</h2>
        <button onclick="checkDetailedStatus()">ğŸ” è©³ç´°ç‹€æ…‹æª¢æŸ¥</button>
        <button onclick="testDirectLogin()">ğŸš€ æ¸¬è©¦ç›´æ¥ç™»å…¥</button>
        <button onclick="resetAuth()">ğŸ”„ é‡ç½®èªè­‰ç‹€æ…‹</button>
        <button onclick="clearBrowserData()">ğŸ§¹ æ¸…é™¤ç€è¦½å™¨æŒ‡å¼•</button>
        
        <h2>ç™»å…¥é€£çµ</h2>
        <p><a href="/api/auth/google?returnTo=%2Fdashboard" target="_blank">ğŸ”— Google OAuth ç™»å…¥</a></p>
        <p><a href="/dashboard" target="_blank">ğŸ“Š ç›´æ¥å‰å¾€å„€è¡¨æ¿</a></p>
        
        <div id="results"></div>
        
        <div id="browserInstructions" style="display:none;" class="info-box">
            <h3>ğŸ§¹ æ¸…é™¤ç€è¦½å™¨è³‡æ–™æ­¥é©Ÿ</h3>
            <ol>
                <li>æŒ‰ F12 é–‹å•Ÿé–‹ç™¼è€…å·¥å…·</li>
                <li>æŒ‰ F5 é‡æ–°æ•´ç†é é¢</li>
                <li>åœ¨ç¶²å€åˆ—å³éµ â†’ æ¸…é™¤ç€è¦½è³‡æ–™</li>
                <li>é¸æ“‡ã€ŒCookie å’Œå…¶ä»–ç¶²ç«™è³‡æ–™ã€</li>
                <li>é»æ“Šã€Œæ¸…é™¤è³‡æ–™ã€</li>
                <li>é—œé–‰ç€è¦½å™¨é‡æ–°é–‹å•Ÿ</li>
            </ol>
        </div>
    </div>

    <script>
        async function checkDetailedStatus() {
            try {
                const response = await fetch('/api/debug/user-status?email=kaoic08@gmail.com');
                const data = await response.json();
                
                document.getElementById('status').innerHTML = `
                    <h3>ğŸ“Š å®Œæ•´ç‹€æ…‹å ±å‘Š</h3>
                    <p><strong>ç”¨æˆ¶ç‹€æ…‹:</strong> ${data.status}</p>
                    <p><strong>Email:</strong> ${data.email || 'N/A'}</p>
                    <p><strong>æœƒå“¡ç­‰ç´š:</strong> ${data.membershipLevel || 'N/A'}</p>
                    <p><strong>ç©åˆ†:</strong> ${data.credits || 'N/A'}</p>
                    <p><strong>Token ç‹€æ…‹:</strong> ${data.tokenValid ? 'âœ… æœ‰æ•ˆ' : 'âŒ ç„¡æ•ˆ'}</p>
                    <p><strong>æœ€å¾Œç™»å…¥:</strong> ${data.lastLoginAt || 'ç„¡è¨˜éŒ„'}</p>
                    <p><strong>æª¢æŸ¥æ™‚é–“:</strong> ${new Date().toLocaleString()}</p>
                `;
                
                document.getElementById('status').className = data.status === 'user_found' ? 'status success' : 'status error';
            } catch (error) {
                document.getElementById('status').innerHTML = `âŒ æª¢æŸ¥å¤±æ•—: ${error.message}`;
                document.getElementById('status').className = 'status error';
            }
        }
        
        async function testDirectLogin() {
            document.getElementById('results').innerHTML = '<p>ğŸ”„ æ¸¬è©¦ç™»å…¥ä¸­...</p>';
            
            // å˜—è©¦å‘¼å«èªè­‰æª¢æŸ¥
            try {
                const response = await fetch('/api/user/me');
                const data = await response.json();
                
                if (response.ok) {
                    document.getElementById('results').innerHTML = `
                        <div class="status success">
                            <h3>âœ… ç™»å…¥æˆåŠŸï¼</h3>
                            <p>ç”¨æˆ¶: ${data.email}</p>
                            <p>æœƒå“¡: ${data.membershipLevel}</p>
                            <p>ç©åˆ†: ${data.credits}</p>
                        </div>
                    `;
                } else {
                    document.getElementById('results').innerHTML = `
                        <div class="status error">
                            <h3>âŒ ç™»å…¥å¤±æ•—</h3>
                            <p>éŒ¯èª¤: ${data.error}</p>
                        </div>
                    `;
                }
            } catch (error) {
                document.getElementById('results').innerHTML = `
                    <div class="status error">
                        <h3>âŒ é€£ç·šéŒ¯èª¤</h3>
                        <p>${error.message}</p>
                    </div>
                `;
            }
        }
        
        async function resetAuth() {
            try {
                const response = await fetch('/api/debug/reset-auth', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email: 'kaoic08@gmail.com' })
                });
                
                const result = await response.json();
                alert(`é‡ç½®çµæœ: ${result.success ? 'âœ… æˆåŠŸ' : 'âŒ å¤±æ•—'} - ${result.message || result.error}`);
                
                checkDetailedStatus();
            } catch (error) {
                alert(`é‡ç½®å¤±æ•—: ${error.message}`);
            }
        }
        
        function clearBrowserData() {
            const instructions = document.getElementById('browserInstructions');
            instructions.style.display = instructions.style.display === 'none' ? 'block' : 'none';
        }
        
        // è‡ªå‹•æª¢æŸ¥ç‹€æ…‹
        checkDetailedStatus();
        
        // æ¯30ç§’é‡æ–°æª¢æŸ¥
        setInterval(checkDetailedStatus, 30000);
    </script>
</body>
</html>