# çµ±ä¸€æŠ˜æ‰£åˆ¸ç³»çµ±å¯¦ä½œå ±å‘Š

## ğŸ¯ ç³»çµ±æ¦‚è¿°

å·²æˆåŠŸå»ºç«‹ **eccal ç‚ºä¸­å¿ƒçš„çµ±ä¸€æŠ˜æ‰£åˆ¸ç³»çµ±**ï¼Œå¯¦ç¾è·¨å¹³å°æŠ˜æ‰£ç®¡ç†å’Œæ‡‰ç”¨ã€‚

## ğŸ—ï¸ ç³»çµ±æ¶æ§‹

### è³‡æ–™åº«æ¶æ§‹
```sql
-- æœå‹™é…ç½®è¡¨
service_configs:
  - service_name (eccal, fabe)
  - service_display_name
  - api_endpoint, webhook_secret
  - supported_currencies, default_currency

-- æŠ˜æ‰£ç¢¼è¡¨
discount_codes:
  - code (å”¯ä¸€)
  - discount_type (percentage/fixed)
  - discount_value
  - applicable_services (è·¨æœå‹™æ”¯æ´)
  - usage_limit, per_user_limit
  - valid_from, valid_until
  - campaign_name, description

-- ä½¿ç”¨è¨˜éŒ„è¡¨
discount_usages:
  - discount_code_id
  - user_email, service_name
  - original_amount, discount_amount, final_amount
  - external_transaction_id
  - payment_status (pending/completed/failed)
```

### API ç«¯é»

#### æ ¸å¿ƒè·¨å¹³å° API
- `POST /api/discount-codes/validate-cross-platform` - è·¨æœå‹™æŠ˜æ‰£é©—è­‰
- `POST /api/discount-codes/apply-cross-platform` - è·¨æœå‹™æŠ˜æ‰£æ‡‰ç”¨
- `GET /api/discount-codes/analytics` - æŠ˜æ‰£çµ±è¨ˆåˆ†æ

#### ç®¡ç†å“¡ API
- `POST /api/admin/discount-codes/create` - å‰µå»ºæŠ˜æ‰£ç¢¼
- `GET /api/admin/discount-codes/list` - æŠ˜æ‰£ç¢¼åˆ—è¡¨
- `PUT /api/admin/discount-codes/:id` - æ›´æ–°æŠ˜æ‰£ç¢¼
- `DELETE /api/admin/discount-codes/:id` - åœç”¨/åˆªé™¤æŠ˜æ‰£ç¢¼
- `GET /api/admin/discount-codes/:id/stats` - å–®ä¸€æŠ˜æ‰£ç¢¼çµ±è¨ˆ

## ğŸ”§ æ ¸å¿ƒåŠŸèƒ½

### 1. è·¨å¹³å°é©—è­‰
```typescript
{
  "code": "WELCOME20",
  "amount": 1000,           // ä¸»è¦è²¨å¹£å–®ä½
  "currency": "TWD",
  "service_name": "eccal",  // æˆ– "fabe"
  "user_email": "user@example.com"
}
```

### 2. å®‰å…¨ä½¿ç”¨è¿½è¹¤
- 30åˆ†é˜æœ‰æ•ˆæœŸçš„ä½¿ç”¨è¿½è¹¤ ID
- é˜²æ­¢é‡è¤‡ä½¿ç”¨å’Œæ¿«ç”¨
- æ”¯æ´å¾…è™•ç†å’Œå·²å®Œæˆç‹€æ…‹

### 3. éˆæ´»çš„æŠ˜æ‰£è¦å‰‡
- **ç™¾åˆ†æ¯”æŠ˜æ‰£**: å¦‚ 20% æŠ˜æ‰£
- **å›ºå®šé‡‘é¡**: å¦‚ NT$100 æŠ˜æ‰£
- **å¤šè²¨å¹£æ”¯æ´**: TWD, USD, JPY
- **æœå‹™é™åˆ¶**: å¯æŒ‡å®š eccal å’Œ/æˆ– fabe
- **ä½¿ç”¨é™åˆ¶**: ç¸½æ¬¡æ•¸å’Œæ¯ç”¨æˆ¶æ¬¡æ•¸
- **æ™‚é–“é™åˆ¶**: ç”Ÿæ•ˆå’Œåˆ°æœŸæ™‚é–“
- **æœ€ä½æ¶ˆè²»**: é˜²æ­¢å°é¡æ¿«ç”¨

### 4. å®Œæ•´çš„ç®¡ç†ç•Œé¢
- æŠ˜æ‰£ç¢¼å‰µå»ºå’Œç·¨è¼¯
- å¯¦æ™‚ä½¿ç”¨çµ±è¨ˆ
- æ‰¹é‡æ“ä½œ
- è©³ç´°çš„ä½¿ç”¨è¨˜éŒ„

## ğŸŒ è·¨å¹³å°æ•´åˆ

### Eccal æ•´åˆ
- å…§å»ºæ–¼ä»˜æ¬¾æµç¨‹
- èˆ‡ Stripe æ•´åˆ
- æœƒå“¡ç³»çµ±è¯å‹•

### Fabe æ•´åˆæº–å‚™
- æ¨™æº–åŒ– API æ¥å£
- æ–‡æª”å’Œæ¸¬è©¦å·¥å…·
- Webhook æ”¯æ´

## ğŸ“Š å•†æ¥­åƒ¹å€¼

### 1. è¡ŒéŠ·æ•ˆç›Š
- **è·¨å¹³å°ä¿ƒéŠ·**: ä¸€å€‹æŠ˜æ‰£ç¢¼å¯ç”¨æ–¼å¤šå€‹æœå‹™
- **ç²¾ç¢ºæ§åˆ¶**: éˆæ´»çš„ä½¿ç”¨é™åˆ¶å’Œæ™‚é–“æ§åˆ¶
- **æ•¸æ“šè¿½è¹¤**: å®Œæ•´çš„ä½¿ç”¨åˆ†æå’Œæ•ˆæœè©•ä¼°

### 2. æŠ€è¡“å„ªå‹¢
- **é¿å…é‡è¤‡é–‹ç™¼**: çµ±ä¸€çš„æŠ˜æ‰£é‚è¼¯
- **ä¸€è‡´æ€§ä¿è­‰**: æ‰€æœ‰æœå‹™ä½¿ç”¨ç›¸åŒè¦å‰‡
- **æ˜“æ–¼ç¶­è­·**: é›†ä¸­ç®¡ç†å’Œæ›´æ–°

### 3. ç”¨æˆ¶é«”é©—
- **çµ±ä¸€é«”é©—**: ç›¸åŒçš„æŠ˜æ‰£ç¢¼ä½¿ç”¨æ–¹å¼
- **ç”Ÿæ…‹é»æ€§**: é¼“å‹µè·¨æœå‹™æ¶ˆè²»
- **é€æ˜è¨ˆç®—**: æ¸…æ¥šçš„æŠ˜æ‰£é¡¯ç¤º

## ğŸš€ éƒ¨ç½²ç‹€æ…‹

### å·²å®Œæˆ
âœ… è³‡æ–™åº«æ¶æ§‹è¨­è¨ˆ  
âœ… æ ¸å¿ƒ API é–‹ç™¼  
âœ… å‰ç«¯çµ„ä»¶ (DiscountCodeInput)  
âœ… ç®¡ç†å¾Œå° (AdminDiscountPage)  
âœ… å®‰å…¨é©—è­‰æ©Ÿåˆ¶  
âœ… å¤šè²¨å¹£æ”¯æ´  
âœ… ä½¿ç”¨è¿½è¹¤ç³»çµ±  

### å¾…å®Œæˆ
â³ è³‡æ–™åº«è¡¨æ ¼å‰µå»º (éœ€æ‰‹å‹•ç¢ºèª)  
â³ Fabe å¹³å° API æ•´åˆ  
â³ ç”Ÿç”¢ç’°å¢ƒæ¸¬è©¦  

## ğŸ”® æœªä¾†è¦åŠƒ

### çŸ­æœŸ (1-2é€±)
- å®Œæˆè³‡æ–™åº«æ¨é€
- å‰µå»ºç¤ºä¾‹æŠ˜æ‰£ç¢¼
- Fabe åœ˜éšŠAPIæ•´åˆ
- ç”Ÿç”¢ç’°å¢ƒæ¸¬è©¦

### ä¸­æœŸ (1å€‹æœˆ)
- é«˜ç´šçµ±è¨ˆå ±è¡¨
- A/B æ¸¬è©¦æ”¯æ´
- è‡ªå‹•åŒ–ä¿ƒéŠ·è¦å‰‡
- ç”¨æˆ¶æ¨è–¦ç³»çµ±æ•´åˆ

### é•·æœŸ (3å€‹æœˆ)
- æ©Ÿå™¨å­¸ç¿’æ¨è–¦
- è¯ç›Ÿè¡ŒéŠ·ç³»çµ±
- ç¬¬ä¸‰æ–¹æœå‹™æ•´åˆ
- åœ‹éš›åŒ–æ“´å±•

## ğŸ“ˆ æˆåŠŸæŒ‡æ¨™

- **æŠ€è¡“æŒ‡æ¨™**: API éŸ¿æ‡‰æ™‚é–“ < 200ms, 99.9% å¯ç”¨æ€§
- **æ¥­å‹™æŒ‡æ¨™**: è·¨å¹³å°è½‰æ›ç‡æå‡ 15%, ç”¨æˆ¶ç”Ÿæ…‹ç•™å­˜æå‡ 25%
- **é‹ç‡ŸæŒ‡æ¨™**: æŠ˜æ‰£ç¢¼å‰µå»ºæ•ˆç‡æå‡ 80%, çµ±è¨ˆåˆ†æå³æ™‚åŒ–

---

**ç¸½çµ**: çµ±ä¸€æŠ˜æ‰£åˆ¸ç³»çµ±å·²å®Œæˆæ ¸å¿ƒé–‹ç™¼ï¼ŒæˆåŠŸå»ºç«‹äº†ä»¥ eccal ç‚ºä¸­å¿ƒçš„è·¨å¹³å°ä¿ƒéŠ·åŸºç¤è¨­æ–½ã€‚ç³»çµ±å…·å‚™é«˜åº¦éˆæ´»æ€§å’Œæ“´å±•æ€§ï¼Œç‚ºæœªä¾†çš„å•†æ¥­æ‹“å±•æ‰“ä¸‹å …å¯¦åŸºç¤ã€‚